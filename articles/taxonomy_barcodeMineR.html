<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Understand the usage of the taxonomy functions
">
<title>Searching taxonomy • barcodeMineR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Searching taxonomy">
<meta property="og:description" content="Understand the usage of the taxonomy functions
">
<meta property="og:image" content="https://matteoce.github.io/barcodeMineR/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">barcodeMineR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../articles/index.html">Articles</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/MatteoCe/barcodeMineR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Searching taxonomy</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/MatteoCe/barcodeMineR/blob/HEAD/vignettes/taxonomy_barcodeMineR.Rmd" class="external-link"><code>vignettes/taxonomy_barcodeMineR.Rmd</code></a></small>
      <div class="d-none name"><code>taxonomy_barcodeMineR.Rmd</code></div>
    </div>

    
    
<p><strong>NOTE: This is a temporary GitHub repository created for
testing purposes.</strong></p>
<p>As mentioned in the <a href="https://matteoce.github.io/barcodeMineR/articles/intro_barcodeMineR.html">introductory
vignette</a>, the basic usage of the <strong>barcodeMineR</strong>
package consists in the adoption of two types of functions that must be
conducted consequently in order to recover a final <em>refdb</em>
object. However, in order to understand exactly which records will be
recovered by the package, a proper understanding of the package function
and rationale is needed.</p>
<div class="section level2">
<h2 id="how-do-the-taxonomy-functions-work">How do the taxonomy functions work<a class="anchor" aria-label="anchor" href="#how-do-the-taxonomy-functions-work"></a>
</h2>
<p>The <a href="https://matteoce.github.io/barcodeMineR/reference/index.html#taxonomy">taxonomy
functions</a> are used to define exactly which records will be retrieved
by the <a href="https://matteoce.github.io/barcodeMineR/reference/index.html#download">download
functions</a>. More precisely, only records that include the
taxid/scientificName, retrieved using the taxonomy functions, as the
lowest taxonomic identification will be downloaded.</p>
<p>Although the basic usage of the two functions <a href="https://matteoce.github.io/barcodeMineR/reference/get_ncbi_taxonomy.html">get_ncbi_taxonomy</a>
and <a href="https://matteoce.github.io/barcodeMineR/reference/get_bold_taxonomy.html">get_bold_taxonomy</a>
is very similar, they slightly differ when it comes to downloading
unclassified records. Below, a thorough explanation of the two function
is described:</p>
<div class="section level3">
<h3 id="ncbi-taxonomy">NCBI taxonomy<a class="anchor" aria-label="anchor" href="#ncbi-taxonomy"></a>
</h3>
<p>For example, the following object, obtained using the
<em>get_ncbi_taxonomy</em> function, will retrieve all NCBI records
corresponding to the species <em>Maldane sarsi</em>, excluding records
identified as a subspecies:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tax_maldane</span></span>
<span><span class="co">#&gt;       queryName  taxid    rank scientificName   phylum      class order</span></span>
<span><span class="co">#&gt; 1 Maldane sarsi 273041 species  Maldane sarsi Annelida Polychaeta    NA</span></span>
<span><span class="co">#&gt;       family   genus       species</span></span>
<span><span class="co">#&gt; 1 Maldanidae Maldane Maldane sarsi</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">maldane_rec</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_ncbi.html">download_ncbi</a></span><span class="op">(</span><span class="va">tax_maldane</span>, ask <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">maldane_rec</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 9</span></span></code></pre></div>
<p>However, in case we were interested in all records identified as
<em>Maldane sarsi</em>, including its children taxonomy, then we would
need to include all species and subspecies in the taxonomy data frame.
In order to do this, running <em>get_ncbi_taxonomy</em> with the
<em>ask</em> argument set to TRUE (default) will prompt the user to
choose which children taxonomic names to retrieve, if they were found by
the function:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tax_maldane</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_ncbi_taxonomy.html">get_ncbi_taxonomy</a></span><span class="op">(</span><span class="st">"Maldane sarsi"</span><span class="op">)</span></span></code></pre></div>
<p>Running the <em>download_ncbi</em> function will search all the
records with <em>Maldane sarsi</em> and <em>Maldane sarsi
antarctica</em> as the lowest taxonomic identification.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># the taxonomy table now includes both species and subspecies:</span></span>
<span><span class="va">tax_maldane</span></span>
<span><span class="co">#&gt;       queryName   taxid       rank           scientificName   phylum      class</span></span>
<span><span class="co">#&gt; 1 Maldane sarsi 1931189 subspecies Maldane sarsi antarctica Annelida Polychaeta</span></span>
<span><span class="co">#&gt; 2 Maldane sarsi  273041    species            Maldane sarsi Annelida Polychaeta</span></span>
<span><span class="co">#&gt;   order     family   genus       species</span></span>
<span><span class="co">#&gt; 1    NA Maldanidae Maldane Maldane sarsi</span></span>
<span><span class="co">#&gt; 2    NA Maldanidae Maldane Maldane sarsi</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">maldane_rec</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_ncbi.html">download_ncbi</a></span><span class="op">(</span><span class="va">tax_maldane</span>, ask <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># the output now include two more records</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">maldane_rec</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 11</span></span></code></pre></div>
<p>This applies to all taxonomic levels. For example, imagine you’re
interested in all <em>Maldane sarsi</em> records on the NCBI. In order
to gather as much sequences as possible, we might also include all those
records identified only at the genus level, in case they include highly
similar sequences that we could use in our analyses. To do this, we
could search for <em>unclassified Maldane</em> and retain all species
and subspecies:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># leaving the ask argument to FALSE will retain all </span></span>
<span><span class="va">additional_tax</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_ncbi_taxonomy.html">get_ncbi_taxonomy</a></span><span class="op">(</span><span class="st">"unclassified Maldane"</span>, ask <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># filter out the "unclassified Maldane" which has no rank</span></span>
<span><span class="va">additional_tax</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">additional_tax</span>, <span class="va">rank</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"species"</span>, <span class="st">"subspecies"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We could merge the two taxonomic tables and thus search all records
corresponding to <em>Maldane sarsi</em>, <em>Maldane sarsi
antarctica</em> plus <em>Maldane sp. 1 GK-2017</em> and <em>Maldane sp.
2 GK-2017</em> and <em>Maldane sp. CBCA-2009</em>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">final_tax</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">tax_maldane</span>, <span class="va">additional_tax</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/download_ncbi.html">download_ncbi</a></span><span class="op">(</span><span class="va">final_tax</span>, ask <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 19 × 30</span></span></span>
<span><span class="co">#&gt;    recordID   markerCode  DNA_seq phylum class order family genus species source</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;DNA&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> OQ053050.1 COX1        <span style="color: #BB0000; font-weight: bold;">AA</span><span style="color: #00BB00; font-weight: bold;">CC</span><span style="color: #0000BB; font-weight: bold;">TT</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… Maldan… NCBI  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> LC342665.1 COX1        <span style="color: #BB0000; font-weight: bold;">AA</span><span style="color: #00BB00; font-weight: bold;">C</span><span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #00BB00; font-weight: bold;">C</span><span style="color: #0000BB; font-weight: bold;">T</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… Maldan… NCBI  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> LC342640.1 COX1        <span style="color: #BB0000; font-weight: bold;">AA</span><span style="color: #00BB00; font-weight: bold;">C</span><span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #0000BB; font-weight: bold;">TT</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… Maldan… NCBI  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> MG421523.1 COI         <span style="color: #BB0000; font-weight: bold;">AA</span><span style="color: #00BB00; font-weight: bold;">C</span><span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #0000BB; font-weight: bold;">TT</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… Maldan… NCBI  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> GQ229112.1 COI         <span style="color: #0000BB; font-weight: bold;">TT</span><span style="color: #BBBB00; font-weight: bold;">G</span><span style="color: #0000BB; font-weight: bold;">T</span><span style="color: #BBBB00; font-weight: bold;">GG</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… Maldan… NCBI  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> OQ071313.1 large subu… <span style="color: #BBBB00; font-weight: bold;">G</span><span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #BBBB00; font-weight: bold;">GGG</span><span style="color: #BB0000; font-weight: bold;">A</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… Maldan… NCBI  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> OQ071256.1 small subu… <span style="color: #00BB00; font-weight: bold;">CC</span><span style="color: #0000BB; font-weight: bold;">TT</span><span style="color: #00BB00; font-weight: bold;">C</span><span style="color: #BBBB00; font-weight: bold;">G</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… Maldan… NCBI  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> LC366965.1 18S riboso… <span style="color: #0000BB; font-weight: bold;">T</span><span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #BBBB00; font-weight: bold;">G</span><span style="color: #0000BB; font-weight: bold;">T</span><span style="color: #00BB00; font-weight: bold;">C</span><span style="color: #BB0000; font-weight: bold;">A</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… Maldan… NCBI  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> LC366940.1 18S riboso… <span style="color: #0000BB; font-weight: bold;">T</span><span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #BBBB00; font-weight: bold;">G</span><span style="color: #0000BB; font-weight: bold;">T</span><span style="color: #00BB00; font-weight: bold;">C</span><span style="color: #BB0000; font-weight: bold;">A</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… Maldan… NCBI  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> LC366001.1 28S riboso… <span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #00BB00; font-weight: bold;">C</span><span style="color: #0000BB; font-weight: bold;">TT</span><span style="color: #BBBB00; font-weight: bold;">GG</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… Maldan… NCBI  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> LC365980.1 28S riboso… <span style="color: #00BB00; font-weight: bold;">CCCC</span><span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #BBBB00; font-weight: bold;">G</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… Maldan… NCBI  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> LC365952.1 16S riboso… <span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #BBBB00; font-weight: bold;">G</span><span style="color: #00BB00; font-weight: bold;">C</span><span style="color: #0000BB; font-weight: bold;">TT</span><span style="color: #00BB00; font-weight: bold;">C</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… Maldan… NCBI  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> KX867346.1 16S riboso… <span style="color: #BBBB00; font-weight: bold;">G</span><span style="color: #0000BB; font-weight: bold;">T</span><span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #0000BB; font-weight: bold;">T</span><span style="color: #00BB00; font-weight: bold;">CC</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… Maldan… NCBI  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> KX867345.1 16S riboso… <span style="color: #0000BB; font-weight: bold;">T</span><span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #0000BB; font-weight: bold;">T</span><span style="color: #00BB00; font-weight: bold;">CC</span><span style="color: #0000BB; font-weight: bold;">T</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… Maldan… NCBI  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> AY612628.1 28S riboso… <span style="color: #00BB00; font-weight: bold;">CC</span><span style="color: #BB0000; font-weight: bold;">AA</span><span style="color: #00BB00; font-weight: bold;">C</span><span style="color: #0000BB; font-weight: bold;">T</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… Maldan… NCBI  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> AY612617.1 18S riboso… <span style="color: #0000BB; font-weight: bold;">T</span><span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #0000BB; font-weight: bold;">T</span><span style="color: #00BB00; font-weight: bold;">C</span><span style="color: #0000BB; font-weight: bold;">TT</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… Maldan… NCBI  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> AY569681.1 16S riboso… <span style="color: #00BB00; font-weight: bold;">C</span><span style="color: #BBBB00; font-weight: bold;">G</span><span style="color: #00BB00; font-weight: bold;">C</span><span style="color: #BBBB00; font-weight: bold;">GG</span><span style="color: #0000BB; font-weight: bold;">T</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… Maldan… NCBI  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> AY569669.1 28S riboso… <span style="color: #0000BB; font-weight: bold;">T</span><span style="color: #BBBB00; font-weight: bold;">G</span><span style="color: #0000BB; font-weight: bold;">T</span><span style="color: #BBBB00; font-weight: bold;">G</span><span style="color: #00BB00; font-weight: bold;">C</span><span style="color: #BBBB00; font-weight: bold;">G</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… Maldan… NCBI  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> AY569655.1 18S riboso… <span style="color: #0000BB; font-weight: bold;">T</span><span style="color: #BBBB00; font-weight: bold;">G</span><span style="color: #00BB00; font-weight: bold;">CC</span><span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #BBBB00; font-weight: bold;">G</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… Maldan… NCBI  </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 20 more variables: lat &lt;dbl&gt;, lon &lt;dbl&gt;, lengthGene &lt;int&gt;, sampleID &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   QueryName &lt;chr&gt;, identified_by &lt;chr&gt;, taxNotes &lt;lgl&gt;, db_xref &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   sourceID &lt;chr&gt;, NCBI_ID &lt;chr&gt;, institutionStoring &lt;lgl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   collected_by &lt;chr&gt;, collection_date &lt;chr&gt;, altitude &lt;lgl&gt;, depth &lt;lgl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   country &lt;lgl&gt;, directionPrimers &lt;lgl&gt;, lengthSource &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   PCR_primers &lt;lgl&gt;, note &lt;lgl&gt;</span></span></span></code></pre></div>
<p>In order to be sure to include all <em>Maldane sarsi</em> records, we
could simply search the genus <em>Maldane</em> and actively select the
species/subspecies we’re interested in. In this case, the base function
<em>grep</em> might come in handy:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tax_maldane</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_ncbi_taxonomy.html">get_ncbi_taxonomy</a></span><span class="op">(</span><span class="st">"Maldane"</span>, ask <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># actively filter all records including the strings "Maldane" and "sarsi" in the</span></span>
<span><span class="co"># field "scientificName"</span></span>
<span><span class="va">tax_maldane_all</span> <span class="op">&lt;-</span> <span class="va">tax_maldane</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"(Maldane).*(sarsi)"</span>, <span class="va">tax_maldane</span><span class="op">$</span><span class="va">scientificName</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">tax_maldane_all</span></span>
<span><span class="co">#&gt;    queryName   taxid       rank            scientificName   phylum      class</span></span>
<span><span class="co">#&gt; 2    Maldane 1931189 subspecies  Maldane sarsi antarctica Annelida Polychaeta</span></span>
<span><span class="co">#&gt; 3    Maldane 2066649    species Maldane cf. sarsi GK-2017 Annelida Polychaeta</span></span>
<span><span class="co">#&gt; 9    Maldane  273041    species             Maldane sarsi Annelida Polychaeta</span></span>
<span><span class="co">#&gt; 13   Maldane  879538    species       Maldane sarsi CMC01 Annelida Polychaeta</span></span>
<span><span class="co">#&gt; 14   Maldane  880914    species       Maldane sarsi CMC02 Annelida Polychaeta</span></span>
<span><span class="co">#&gt;    order     family   genus                   species</span></span>
<span><span class="co">#&gt; 2     NA Maldanidae Maldane             Maldane sarsi</span></span>
<span><span class="co">#&gt; 3     NA Maldanidae Maldane Maldane cf. sarsi GK-2017</span></span>
<span><span class="co">#&gt; 9     NA Maldanidae Maldane             Maldane sarsi</span></span>
<span><span class="co">#&gt; 13    NA Maldanidae Maldane       Maldane sarsi CMC01</span></span>
<span><span class="co">#&gt; 14    NA Maldanidae Maldane       Maldane sarsi CMC02</span></span></code></pre></div>
<p>By merging this data frame with the one including all
<em>unclassified Maldane</em> we can be confident to download most of
the available <em>Maldane sarsi</em> records from the NCBI:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">all_maldane</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">tax_maldane_all</span>, <span class="va">additional_tax</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ncbi_maldane</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_ncbi.html">download_ncbi</a></span><span class="op">(</span><span class="va">all_maldane</span>, ask <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">ncbi_maldane</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 29 × 30</span></span></span>
<span><span class="co">#&gt;    recordID   markerCode DNA_seq  phylum class order family genus species source</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;DNA&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> OQ053050.1 COX1       <span style="color: #BB0000; font-weight: bold;">AA</span><span style="color: #00BB00; font-weight: bold;">CC</span><span style="color: #0000BB; font-weight: bold;">TT</span><span style="color: #BB0000; font-weight: bold;">A</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… Maldan… NCBI  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> LC342665.1 COX1       <span style="color: #BB0000; font-weight: bold;">AA</span><span style="color: #00BB00; font-weight: bold;">C</span><span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #00BB00; font-weight: bold;">C</span><span style="color: #0000BB; font-weight: bold;">T</span><span style="color: #BB0000; font-weight: bold;">A</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… Maldan… NCBI  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> LC342640.1 COX1       <span style="color: #BB0000; font-weight: bold;">AA</span><span style="color: #00BB00; font-weight: bold;">C</span><span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #0000BB; font-weight: bold;">TT</span><span style="color: #BB0000; font-weight: bold;">A</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… Maldan… NCBI  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> LC342639.1 COX1       <span style="color: #BB0000; font-weight: bold;">AA</span><span style="color: #00BB00; font-weight: bold;">C</span><span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #0000BB; font-weight: bold;">TT</span><span style="color: #BB0000; font-weight: bold;">A</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… Maldan… NCBI  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> MG421523.1 COI        <span style="color: #BB0000; font-weight: bold;">AA</span><span style="color: #00BB00; font-weight: bold;">C</span><span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #0000BB; font-weight: bold;">TT</span><span style="color: #BB0000; font-weight: bold;">A</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… Maldan… NCBI  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> HQ023885.1 COI        <span style="color: #BB0000; font-weight: bold;">AA</span><span style="color: #00BB00; font-weight: bold;">C</span><span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #0000BB; font-weight: bold;">TT</span><span style="color: #BB0000; font-weight: bold;">A</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… Maldan… NCBI  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> GQ229112.1 COI        <span style="color: #0000BB; font-weight: bold;">TT</span><span style="color: #BBBB00; font-weight: bold;">G</span><span style="color: #0000BB; font-weight: bold;">T</span><span style="color: #BBBB00; font-weight: bold;">GG</span><span style="color: #0000BB; font-weight: bold;">T</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… Maldan… NCBI  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> GU672597.1 COI        <span style="color: #BBBB00; font-weight: bold;">GG</span><span style="color: #BB0000; font-weight: bold;">AA</span><span style="color: #00BB00; font-weight: bold;">C</span><span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #0000BB; font-weight: bold;">T</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… Maldan… NCBI  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> GU672596.1 COI        <span style="color: #BBBB00; font-weight: bold;">GG</span><span style="color: #BB0000; font-weight: bold;">AA</span><span style="color: #00BB00; font-weight: bold;">C</span><span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #0000BB; font-weight: bold;">T</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… Maldan… NCBI  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> GU672576.1 COI        <span style="color: #BBBB00; font-weight: bold;">GG</span><span style="color: #BB0000; font-weight: bold;">AA</span><span style="color: #00BB00; font-weight: bold;">C</span><span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #0000BB; font-weight: bold;">T</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… Maldan… NCBI  </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 19 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 20 more variables: lat &lt;dbl&gt;, lon &lt;dbl&gt;, lengthGene &lt;int&gt;, sampleID &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   QueryName &lt;chr&gt;, identified_by &lt;chr&gt;, taxNotes &lt;lgl&gt;, db_xref &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   sourceID &lt;chr&gt;, NCBI_ID &lt;chr&gt;, institutionStoring &lt;lgl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   collected_by &lt;chr&gt;, collection_date &lt;chr&gt;, altitude &lt;lgl&gt;, depth &lt;lgl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   country &lt;lgl&gt;, directionPrimers &lt;lgl&gt;, lengthSource &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   PCR_primers &lt;lgl&gt;, note &lt;lgl&gt;</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="bold-taxonomy">BOLD taxonomy<a class="anchor" aria-label="anchor" href="#bold-taxonomy"></a>
</h3>
<p>The basic usage of <a href="https://matteoce.github.io/barcodeMineR/reference/get_bold_taxonomy.html">get_bold_taxonomy</a>
follows the same methodology. In order to obtain all <em>Maldane
sarsi</em> records, we first need to get the corresponding taxonomy data
frame:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tax_maldane</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_bold_taxonomy.html">get_bold_taxonomy</a></span><span class="op">(</span><span class="st">"Maldane sarsi"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/download_bold.html">download_bold</a></span><span class="op">(</span><span class="va">tax_maldane</span>, ask <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 30</span></span></span>
<span><span class="co">#&gt;   recordID    markerCode DNA_seq  phylum class order family genus species source</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;DNA&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> BBAY119-13  COI-5P     <span style="color: #BB0000; font-weight: bold;">AA</span><span style="color: #00BB00; font-weight: bold;">C</span><span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #0000BB; font-weight: bold;">TT</span><span style="color: #BB0000; font-weight: bold;">A</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… Maldan… BOLD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> BBPS424-19  COI-5P     <span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #0000BB; font-weight: bold;">TTTT</span><span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #0000BB; font-weight: bold;">T</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… Maldan… BOLD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> BBPS596-19  COI-5P     <span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #0000BB; font-weight: bold;">TTTT</span><span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #0000BB; font-weight: bold;">T</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… Maldan… BOLD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> BBPS597-19  COI-5P     <span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #0000BB; font-weight: bold;">TTTT</span><span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #0000BB; font-weight: bold;">T</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… Maldan… BOLD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> BHAK7250-22 COI-5P     -------… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… Maldan… BOLD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> CMBIA384-11 COI-5P     <span style="color: #BB0000; font-weight: bold;">AA</span><span style="color: #00BB00; font-weight: bold;">C</span><span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #0000BB; font-weight: bold;">TT</span><span style="color: #BB0000; font-weight: bold;">A</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… Maldan… BOLD  </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 20 more variables: lat &lt;dbl&gt;, lon &lt;dbl&gt;, lengthGene &lt;int&gt;, sampleID &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   QueryName &lt;chr&gt;, identified_by &lt;chr&gt;, taxNotes &lt;lgl&gt;, db_xref &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   sourceID &lt;chr&gt;, NCBI_ID &lt;chr&gt;, institutionStoring &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   collected_by &lt;chr&gt;, collection_date &lt;lgl&gt;, altitude &lt;lgl&gt;, depth &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   country &lt;chr&gt;, directionPrimers &lt;chr&gt;, lengthSource &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   PCR_primers &lt;chr&gt;, note &lt;lgl&gt;</span></span></span></code></pre></div>
<p>The main difference between the NCBI taxonomy function and
<em>get_bold_taxonomy</em> actually relates to the subsequent recovery
of records. In fact, the BOLD database does not include an “unclassified
taxon” rank that includes all records identified to that taxonomic
level, but with no species name. However, the publication of records on
the BOLD database does not require necessarily an identification at the
species level, meaning that searching higher level taxonomies would
result in the download of all records belonging to that taxon,
independently from the presence of an identification at lower taxonomic
levels.</p>
<p>In order to follow the same principle of the NCBI function, however,
searching a higher level taxa with <em>get_bold_taxonomy</em> will
result in the download of only those records identified up to that
taxon. In the lines below, the <em>descend</em> argument is set to
FALSE, in order to avoid the internal children taxa searching method
using the package <a href="https://github.com/ropensci/taxize" class="external-link">taxize</a>, resulting in
including only the taxon <em>Maldane</em> in the final taxonomy data
frame.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bold_tax_maldane</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_bold_taxonomy.html">get_bold_taxonomy</a></span><span class="op">(</span><span class="st">"Maldane"</span>, descend <span class="op">=</span> <span class="cn">FALSE</span>, ask <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">maldane_bold</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_bold.html">download_bold</a></span><span class="op">(</span><span class="va">bold_tax_maldane</span>, ask <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">maldane_bold</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 7 × 30</span></span></span>
<span><span class="co">#&gt;   recordID     markerCode DNA_seq phylum class order family genus species source</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;DNA&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> GBAN15869-19 COI-5P     <span style="color: #BB0000; font-weight: bold;">AA</span><span style="color: #00BB00; font-weight: bold;">C</span><span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #0000BB; font-weight: bold;">TT</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… <span style="color: #BB0000;">NA</span>      BOLD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> GBAN15870-19 COI-5P     <span style="color: #BB0000; font-weight: bold;">AA</span><span style="color: #00BB00; font-weight: bold;">C</span><span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #0000BB; font-weight: bold;">TT</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… <span style="color: #BB0000;">NA</span>      BOLD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> GBAN15893-19 COI-5P     <span style="color: #BBBB00; font-weight: bold;">GG</span><span style="color: #0000BB; font-weight: bold;">T</span><span style="color: #BBBB00; font-weight: bold;">G</span><span style="color: #00BB00; font-weight: bold;">CC</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… <span style="color: #BB0000;">NA</span>      BOLD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> GBAN15895-19 COI-5P     <span style="color: #BB0000; font-weight: bold;">AA</span><span style="color: #00BB00; font-weight: bold;">C</span><span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #00BB00; font-weight: bold;">C</span><span style="color: #0000BB; font-weight: bold;">T</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… <span style="color: #BB0000;">NA</span>      BOLD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> GBAN15900-19 COI-5P     <span style="color: #BBBB00; font-weight: bold;">G</span><span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #00BB00; font-weight: bold;">C</span><span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #0000BB; font-weight: bold;">TT</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… <span style="color: #BB0000;">NA</span>      BOLD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> POLNB273-13  COI-5P     <span style="color: #BB0000; font-weight: bold;">AA</span><span style="color: #0000BB; font-weight: bold;">T</span><span style="color: #BB0000; font-weight: bold;">AA</span><span style="color: #0000BB; font-weight: bold;">T</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… <span style="color: #BB0000;">NA</span>      BOLD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> POLNB275-13  COI-5P     <span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #0000BB; font-weight: bold;">TT</span><span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #BBBB00; font-weight: bold;">GG</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… <span style="color: #BB0000;">NA</span>      BOLD  </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 20 more variables: lat &lt;dbl&gt;, lon &lt;dbl&gt;, lengthGene &lt;int&gt;, sampleID &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   QueryName &lt;chr&gt;, identified_by &lt;chr&gt;, taxNotes &lt;lgl&gt;, db_xref &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   sourceID &lt;chr&gt;, NCBI_ID &lt;chr&gt;, institutionStoring &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   collected_by &lt;chr&gt;, collection_date &lt;lgl&gt;, altitude &lt;lgl&gt;, depth &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   country &lt;chr&gt;, directionPrimers &lt;chr&gt;, lengthSource &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   PCR_primers &lt;chr&gt;, note &lt;chr&gt;</span></span></span></code></pre></div>
<p>The 7 records are only identified up to the genus <em>Maldane</em>,
thus, if we wanted to recover all records potentially belonging to the
<em>Maldane sarsi</em> species we would have to merge the two taxonomy
data frames and search all unidentified <em>Maldane</em> records
together with those identified as <em>Maldane sarsi</em>. Ideally, this
would be the simplest approach:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bold_tax_maldane</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_bold_taxonomy.html">get_bold_taxonomy</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Maldane"</span>, <span class="st">"Maldane sarsi"</span><span class="op">)</span>, descend <span class="op">=</span> <span class="cn">FALSE</span>, ask <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">maldane_bold</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_bold.html">download_bold</a></span><span class="op">(</span><span class="va">bold_tax_maldane</span>, ask <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">maldane_bold</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 13 × 30</span></span></span>
<span><span class="co">#&gt;    recordID    markerCode DNA_seq phylum class order family genus species source</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;DNA&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> GBAN15869-… COI-5P     <span style="color: #BB0000; font-weight: bold;">AA</span><span style="color: #00BB00; font-weight: bold;">C</span><span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #0000BB; font-weight: bold;">TT</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… <span style="color: #BB0000;">NA</span>      BOLD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> GBAN15870-… COI-5P     <span style="color: #BB0000; font-weight: bold;">AA</span><span style="color: #00BB00; font-weight: bold;">C</span><span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #0000BB; font-weight: bold;">TT</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… <span style="color: #BB0000;">NA</span>      BOLD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> GBAN15893-… COI-5P     <span style="color: #BBBB00; font-weight: bold;">GG</span><span style="color: #0000BB; font-weight: bold;">T</span><span style="color: #BBBB00; font-weight: bold;">G</span><span style="color: #00BB00; font-weight: bold;">CC</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… <span style="color: #BB0000;">NA</span>      BOLD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> GBAN15895-… COI-5P     <span style="color: #BB0000; font-weight: bold;">AA</span><span style="color: #00BB00; font-weight: bold;">C</span><span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #00BB00; font-weight: bold;">C</span><span style="color: #0000BB; font-weight: bold;">T</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… <span style="color: #BB0000;">NA</span>      BOLD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> GBAN15900-… COI-5P     <span style="color: #BBBB00; font-weight: bold;">G</span><span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #00BB00; font-weight: bold;">C</span><span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #0000BB; font-weight: bold;">TT</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… <span style="color: #BB0000;">NA</span>      BOLD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> POLNB273-13 COI-5P     <span style="color: #BB0000; font-weight: bold;">AA</span><span style="color: #0000BB; font-weight: bold;">T</span><span style="color: #BB0000; font-weight: bold;">AA</span><span style="color: #0000BB; font-weight: bold;">T</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… <span style="color: #BB0000;">NA</span>      BOLD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> POLNB275-13 COI-5P     <span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #0000BB; font-weight: bold;">TT</span><span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #BBBB00; font-weight: bold;">GG</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… <span style="color: #BB0000;">NA</span>      BOLD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> BBAY119-13  COI-5P     <span style="color: #BB0000; font-weight: bold;">AA</span><span style="color: #00BB00; font-weight: bold;">C</span><span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #0000BB; font-weight: bold;">TT</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… Maldan… BOLD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> BBPS424-19  COI-5P     <span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #0000BB; font-weight: bold;">TTTT</span><span style="color: #BB0000; font-weight: bold;">A</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… Maldan… BOLD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> BBPS596-19  COI-5P     <span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #0000BB; font-weight: bold;">TTTT</span><span style="color: #BB0000; font-weight: bold;">A</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… Maldan… BOLD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> BBPS597-19  COI-5P     <span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #0000BB; font-weight: bold;">TTTT</span><span style="color: #BB0000; font-weight: bold;">A</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… Maldan… BOLD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> BHAK7250-22 COI-5P     ------… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… Maldan… BOLD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> CMBIA384-11 COI-5P     <span style="color: #BB0000; font-weight: bold;">AA</span><span style="color: #00BB00; font-weight: bold;">C</span><span style="color: #BB0000; font-weight: bold;">A</span><span style="color: #0000BB; font-weight: bold;">TT</span>… Annel… Poly… <span style="color: #BB0000;">NA</span>    Malda… Mald… Maldan… BOLD  </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 20 more variables: lat &lt;dbl&gt;, lon &lt;dbl&gt;, lengthGene &lt;int&gt;, sampleID &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   QueryName &lt;chr&gt;, identified_by &lt;chr&gt;, taxNotes &lt;lgl&gt;, db_xref &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   sourceID &lt;chr&gt;, NCBI_ID &lt;chr&gt;, institutionStoring &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   collected_by &lt;chr&gt;, collection_date &lt;lgl&gt;, altitude &lt;lgl&gt;, depth &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   country &lt;chr&gt;, directionPrimers &lt;chr&gt;, lengthSource &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   PCR_primers &lt;chr&gt;, note &lt;chr&gt;</span></span></span></code></pre></div>
<p>As in the above section, serching all taxa for <em>Maldane</em> and
then filtering only those including the strings “Maldane” and “sarsi”
using <em>grep</em> would increase our chances to include records with
identification qualifiers like “cf.”, however, for long vectors
including many different taxa this might result in frequent blocking by
the BOLD servers, as explained in the vignette topic <a href="https://matteoce.github.io/barcodeMineR/#Why-can't-I-speed-up-the-BOLD-functions?">Why
can’t I speed up the BOLD functions?</a>.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matteo Cecchetto.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
